 sc2019 %>% filter(game_type=='R' & pitch_name =='4-Seam Fastball' & (pitcher_name =='Justin Verlander' | pitcher_name =='Walker Buehler'| pitcher_name =='Mike Minor'|pitcher_name =='Jon Gray'|pitcher_name=='Hyun-Jin Ryu'|pitcher_name =='Trevor Bauer')) %>% ggplot(aes(as.factor(inning),release_speed,fill=pitcher_name))+geom_boxplot(alpha=.7)+facet_wrap(.~pitcher_name)+scale_y_continuous(breaks=seq(87,100,1),"Pitch Speed")+coord_cartesian(ylim = c(87,100))+geom_hline(yintercept = c(87,88,89,90,91,92,93,94,95,96,97,98,99,100),linetype=2,alpha=.2)+theme_base()+scale_fill_manual(values = c('#005A9C','#33006F','#EB6E1F','#C0111F','#000000','#A5ACAF'),"Pitcher")+labs(title = "4-Seam Fastball Pitch Speed By Inning" , subtitle = 'Regular Season: 2019',x = "Inning", caption = "Source: Baseball Savant; baseballr")


sc2019 %>% filter(game_type=='R') %>% group_by(pitcher_name,inning ,pitch_name) %>% summarise(avg.speed = mean(release_speed,na.rm=T), count=n()) %>% filter(pitch_name =='4-Seam Fastball') %>% filter(inning %in% c(1,9)) Â %>% spread(inning,avg.speed) %>% select(pitcher_name,'1','9') %>% rename("inn1"='1') %>% rename("inn9"='9') %>% replace_na(list(inn1=0)) %>% replace_na(list(inn9=0)) %>% gather(inn1,inn9,key='inning',value = 'avg.speed') %>% filter(avg.speed != 0) %>% spread(inning,avg.speed) %>% mutate(diff = inn9-inn1) %>% filter(!is.na(diff)) %>% arrange(-diff)
